<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Simon</title>
    <style>
        body {
            background-color: lightslategrey;
            background-image: url("img/gcjill.jpg");
            background-repeat: no-repeat;
            background-size: 100%, 100%;
        }
        #buttonscontainer{
            position:relative;
            width: 80%;
            height: 80%;
            margin: auto;
        }
        div {
            position: absolute;
            height: auto;
            width: auto;
            max-width: 50%;
            max-height: 100%;
            margin: 0;
            color: white;
        }
        #red {
            top: 0;
            left: 0;
        }
        #green {
            top: 0;
            left: 50%;
        }
        #blue {
            top: 50%;
            left: 0;
        }
        #yellow {
            top:50%;
            left: 50%;
        }
        button {
            margin-left: 25%;
            width: 50%;
            height: 20%;
            font-size: 15vh;
        }
        #backgroundsquares {
            height: auto;
            width: auto;
            max-width: 100%;
            max-height: 100%;
            z-index: -1;
        }
        img {
            width: 100%;
            height: 100%;
        }
        audio {
            float: right;
            width: 400px;
        }
    </style>
</head>
<body>
<audio id="music" loop preload controls src="sounds/KarmotrineDream.mp3"></audio>
<div id="buttonscontainer">
    <img id="backgroundsquares" src="img/squares.png">
    <div id="red"><img src="img/red.png"></div>
    <div id="green"><img src="img/green.png"></div>
    <div id="blue"><img src="img/blue.png"></div>
    <div id="yellow"><img src="img/yellow.png"></div>
</div>
    <button>Start</button>
<div id="cbam">Cyberpunk Bartender Action Mode</div> <!-- Super less than secret second game! :O -->


    <script src="js/howler.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script>
        var randomized = '';
        var entered = '';
        var clickable = false;
        var score = 0;
        var red = $('#red');
        var blue = $('#blue');
        var green = $('#green');
        var yellow = $('#yellow');
        var sound = new Howl({
            src: ['sounds/soundsprite.ogg'],
            sprite: {
                error: [0, 1500],
                red: [2000, 2000],
                blue: [4000, 2500],
                green: [7000, 1000],
                yellow: [8000, 2000]
            }
        });
        var cbam = $('#cbam'); // Unused ATM for super-not-very-hidden secondary game I may add
        var music = document.getElementById('music');
        setTimeout(function(){music.play()}, 1000);
        music.volume = 0.6;

        var randomizer = function(){return Math.floor(Math.random() * 4)};

        $('button').click(function(){
            randomized = '';
            alert("Starting now!");
            animateOld();
        });
        red.click(function(){
            if(clickable == false) {
            } else {
                entered += "r";
                red.fadeOut(100).fadeIn(100);
                clickable = false;
                if(entered.substring(0) != randomized.substring(0, entered.length)){
                    entered = '';
                    randomized = '';
                    sound.play('error');
                    alert("You lose! Score: "+ score + " || Try again.");
                    score = 0;
                } else if (entered == randomized) {
                    sound.play('red');
                    setTimeout(function(){animateOld();}, 1500);
                    entered = '';
                    score ++;
                } else {
                    sound.play('red');
                    clickable = true;
                }
            }
        });
        blue.click(function(){
            if(clickable == false) {
            } else {
                entered += "b";
                blue.fadeOut(100).fadeIn(100);
                clickable = false;
                if(entered.substring(0) != randomized.substring(0, entered.length)){
                    entered = '';
                    randomized = '';
                    sound.play('error');
                    alert("You lose! Score: "+ score + " || Try again.");
                    score = 0;
                } else if (entered == randomized) {
                    sound.play('blue');
                    setTimeout(function(){animateOld();}, 1500);
                    entered = '';
                    score ++;
                } else {
                    sound.play('blue');
                    clickable = true;
                }
            }
        });
        green.click(function(){
            if(clickable == false) {
            } else {
                entered += "g";
                green.fadeOut(100).fadeIn(100);
                clickable = false;
                if(entered.substring(0) != randomized.substring(0, entered.length)){
                    entered = '';
                    randomized = '';
                    sound.play('error');
                    alert("You lose! Score: "+ score + " || Try again.");
                    score = 0;
                } else if (entered == randomized) {
                    sound.play('green');
                    setTimeout(function(){animateOld();}, 1500);
                    entered = '';
                    score ++;
                } else {
                    sound.play('green');
                    clickable = true;
                }
            }
        });
        yellow.click(function(){
            if(clickable == false) {
            } else {
                entered += "y";
                yellow.fadeOut(100).fadeIn(100);
                clickable = false;
                if(entered.substring(0) != randomized.substring(0, entered.length)){
                    entered = '';
                    randomized = '';
                    sound.play('error');
                    alert("You lose! Score: "+ score + " || Try again.");
                    score = 0;
                } else if (entered == randomized) {
                    sound.play('yellow');
                    setTimeout(function(){animateOld();}, 1500);
                    entered = '';
                    score ++;
                } else {
                    sound.play('yellow');
                    clickable = true;
                }

            }
        });


        function rgby() {
            var random = randomizer();
            console.log(random);
            if(random == 0){
                randomized += 'r';
            } else if (random == 1) {
                randomized += 'g';
            } else if (random == 2) {
                randomized += 'b';
            } else {
                randomized += 'y';
            }
            console.log('randomized = ' + randomized);
        }
        function animateOld() {
                var i = 0;
                rgby();
                var IntervalOne = setInterval(function(){
                console.log("i = " + i);
                console.log(randomized.charAt(i));
                var color = randomized.charAt(i);
                if(randomized.charAt(i) == 'r'){
                    console.log("animating red");
                    red.fadeOut(300).fadeIn(300);
                    sound.play('red');
                } else if (randomized.charAt(i) == 'g') {
                    console.log("animating green");
                    green.fadeOut(300).fadeIn(300);
                    sound.play('green');
                } else if (randomized.charAt(i) == 'b') {
                    console.log("animating blue");
                    blue.fadeOut(300).fadeIn(300);
                    sound.play('blue');
                } else if (randomized.charAt(i) == 'y') {
                    console.log("animating yellow");
                    yellow.fadeOut(300).fadeIn(300);
                    sound.play('yellow');
                } else {
                    console.log("WTF is happening? color " + color + " i " + i);
                }
                if(i == randomized.length - 1){
                    clearInterval(IntervalOne);
                    clickable = true;
                } else {
                    i++;
                }
                }, 800);
        }
    </script>
</body>
</html>